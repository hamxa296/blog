<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oceanic Blog</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        navy: '#0A1931',
                        deep: '#1A3D63',
                        steel: '#4A7FA7',
                        light: '#B3CFE5',
                        snow: '#F6FAFD',
                    }
                }
            }
        }
    </script>
    <style>
        .reaction-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .reaction-btn:hover {
            transform: translateY(-3px);
        }
        
        .reaction-btn:active {
            transform: translateY(0);
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        
        .sticker {
            position: absolute;
            opacity: 0.8;
            z-index: 10;
            animation: float 6s ease-in-out infinite;
        }
        
        .sticker-1 {
            top: 10%;
            left: 5%;
            animation-delay: 0s;
        }
        
        .sticker-2 {
            bottom: 15%;
            right: 5%;
            animation-delay: 2s;
        }
        
        .content-wrapper {
            position: relative;
        }
        
        @media (min-width: 768px) {
            .sticker-1 {
                top: 15%;
                left: 10%;
            }
            
            .sticker-2 {
                bottom: 20%;
                right: 10%;
            }
        }
        
        .prose {
            max-width: 65ch;
        }
        
        .prose p {
            margin-bottom: 1.5rem;
            line-height: 1.7;
        }
        
        .prose h2 {
            margin-top: 2.5rem;
            margin-bottom: 1.5rem;
            position: relative;
            padding-left: 1rem;
        }
        
        .prose h2::before {
            content: "";
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: #4A7FA7;
            border-radius: 2px;
        }
    </style>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
    <script src="firebase-config.js"></script>
    <script src="combined.min.js"></script>
</head>
<body class="bg-steel min-h-screen font-sans text-white">
    <!-- Stickers -->
    <div class="sticker sticker-1">
        <svg width="60" height="60" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20Z" fill="#B3CFE5"/>
            <path d="M12 6C8.69 6 6 8.69 6 12C6 15.31 8.69 18 12 18C15.31 18 18 15.31 18 12C18 8.69 15.31 6 12 6ZM12 16C9.79 16 8 14.21 8 12C8 9.79 9.79 8 12 8C14.21 8 16 9.79 16 12C16 14.21 14.21 16 12 16Z" fill="#4A7FA7"/>
        </svg>
    </div>
    
    <div class="sticker sticker-2">
        <svg width="80" height="80" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9 2L7.17 4H4C2.9 4 2 4.9 2 6V18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V6C22 4.9 21.1 4 20 4H16.83L15 2H9ZM12 17C9.24 17 7 14.76 7 12C7 9.24 9.24 7 12 7C14.76 7 17 9.24 17 12C17 14.76 14.76 17 12 17Z" fill="#F6FAFD"/>
            <path d="M12 9C10.34 9 9 10.34 9 12C9 13.66 10.34 15 12 15C13.66 15 15 13.66 15 12C15 10.34 13.66 9 12 9Z" fill="#1A3D63"/>
        </svg>
    </div>
    
    <!-- Content -->
    <div class="content-wrapper pb-16">
        <div id="post-container" class="max-w-4xl mx-auto bg-deep/90 backdrop-blur-sm rounded-xl p-6 md:p-8 shadow-lg">
        <main class="container mx-auto px-4 pt-8">
            <!-- Featured Image -->
            <div class="rounded-xl overflow-hidden shadow-xl mb-8">
                <img id="post-image" src="https://images.unsplash.com/photo-1505118380757-91f5f5632de0?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80" 
                     alt="Post image" 
                     class="w-full h-64 md:h-96 object-cover">
            </div>
            
            <!-- Article Content -->
            <div class="rounded-xl p-6 md:p-8">
                <article id="post-content" class="prose mx-auto">
                <!-- Meta -->
                <div class="flex items-center space-x-4 mb-6">
                    <span id="post-date" class="text-sm font-medium text-steel"></span>
                    <span class="w-1 h-1 rounded-full bg-steel"></span>
                    <span id="post-author" class="text-sm font-medium text-steel"></span>
                </div>
                
                <!-- Title -->
                <h1 id="post-title" class="text-3xl md:text-4xl font-bold text-white mb-6"></h1>
                
                <!-- Content -->
                <div id="post-body"></div>
                </article>
            </div>
            
            </div>

            <!-- Tags -->
            <div id="post-tags" class="flex flex-wrap gap-2 mt-12 justify-center">
            </div>

            <!-- Reactions -->
            <div class="mt-12 border-t border-light pt-8">
                <h3 class="text-xl font-bold text-white mb-6">How did this article make you feel?</h3>
                <div class="flex justify-center gap-8">
                    <button class="reaction-btn group" data-reaction="thumbs-up">
                        <div class="p-3 rounded-full bg-deep group-hover:bg-light transition-all duration-300">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M14 14V9H16C16.55 9 17 8.55 17 8V7C17 6.45 16.55 6 16 6H14V4C14 3.45 13.55 3 13 3H7V15H12L14 14ZM5 15H3V4C3 3.45 3.45 3 4 3H5V15Z" class="fill-steel group-hover:fill-deep transition-all duration-300"/>
                            </svg>
                        </div>
                        <span class="text-sm font-medium text-steel mt-2 group-hover:text-white transition-all duration-300">Like</span>
                    </button>
                    <button class="reaction-btn group" data-reaction="heart">
                        <div class="p-3 rounded-full bg-deep group-hover:bg-light transition-all duration-300">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 21.35L10.55 20.03C5.4 15.36 2 12.28 2 8.5C2 5.42 4.42 3 7.5 3C9.24 3 10.91 3.81 12 5.09C13.09 3.81 14.76 3 16.5 3C19.58 3 22 5.42 22 8.5C22 12.28 18.6 15.36 13.45 20.03L12 21.35Z" class="fill-steel group-hover:fill-deep transition-all duration-300"/>
                            </svg>
                        </div>
                        <span class="text-sm font-medium text-steel mt-2 group-hover:text-white transition-all duration-300">Love</span>
                    </button>
                    <button class="reaction-btn group" data-reaction="celebrate">
                        <div class="p-3 rounded-full bg-deep group-hover:bg-light transition-all duration-300">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 17.27L18.18 21L16.54 13.97L22 9.24L14.81 8.63L12 2L9.19 8.63L2 9.24L7.46 13.97L5.82 21L12 17.27Z" class="fill-steel group-hover:fill-deep transition-all duration-300"/>
                            </svg>
                        </div>
                        <span class="text-sm font-medium text-steel mt-2 group-hover:text-white transition-all duration-300">Celebrate</span>
                    </button>
                    <button class="reaction-btn group" data-reaction="bulb">
                        <div class="p-3 rounded-full bg-deep group-hover:bg-light transition-all duration-300">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 3C8.69 3 6 5.69 6 9C6 11.05 7.23 12.81 9 13.63V15C9 15.55 9.45 16 10 16H14C14.55 16 15 15.55 15 15V13.63C16.77 12.81 18 11.05 18 9C18 5.69 15.31 3 12 3ZM14 14H10V13.5C10 13.22 10.22 13 10.5 13H13.5C13.78 13 14 13.22 14 13.5V14ZM10 18H14V19C14 19.55 13.55 20 13 20H11C10.45 20 10 19.55 10 19V18Z" class="fill-steel group-hover:fill-deep transition-all duration-300"/>
                            </svg>
                        </div>
                        <span class="text-sm font-medium text-steel mt-2 group-hover:text-white transition-all duration-300">Insightful</span>
                    </button>
                </div>
            </div>

            <!-- Comments Section -->
            <div id="comments-section" class="mt-12 border-t border-light pt-8 px-4 md:px-6">
                <h3 class="text-xl font-bold text-white mb-6">Comments</h3>
                
                <!-- Comment Form -->
                <div class="mb-8">
                    <textarea id="comment-input" class="w-full p-4 border border-light rounded-lg focus:outline-none focus:ring-2 focus:ring-light bg-deep text-white" rows="4" placeholder="Share your thoughts..."></textarea>
                    <button id="post-comment-btn" class="mt-3 px-6 py-2 bg-light text-steel rounded-lg hover:bg-white transition">Post Comment</button>
                </div>

                <!-- Comments List -->
                <div id="comments-list" class="space-y-6">
                    <!-- Comments will be dynamically inserted here -->
                </div>
            </div>
        </main>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            const urlParams = new URLSearchParams(window.location.search);
            const postId = urlParams.get('id');

            if (!postId) {
                document.getElementById('post-container').innerHTML = '<h1 class="text-white text-center text-2xl">Post not found. Please provide a post ID.</h1>';
                return;
            }

            try {
                const post = await getPostById(postId);

                if (post) {
                    document.title = post.title + " | Oceanic Blog";
                    document.getElementById('post-title').textContent = post.title;
                    document.getElementById('post-image').src = post.photoUrl || 'https://images.unsplash.com/photo-1505118380757-91f5f5632de0?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80';
                    document.getElementById('post-image').alt = post.title;
                    document.getElementById('post-date').textContent = post.createdAt.toDate().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
                    document.getElementById('post-author').textContent = `By ${post.authorName}`;
                    document.getElementById('post-body').innerHTML = post.content;

                    const tagsContainer = document.getElementById('post-tags');
                    tagsContainer.innerHTML = '';
                    if (post.tags && post.tags.length > 0) {
                        post.tags.forEach(tag => {
                            const tagElement = document.createElement('span');
                            tagElement.className = 'px-3 py-1 bg-light text-steel rounded-full text-sm font-medium hover:bg-white transition';
                            tagElement.textContent = tag;
                            tagsContainer.appendChild(tagElement);
                        });
                    }
                } else {
                    document.getElementById('post-container').innerHTML = '<h1 class="text-white text-center text-2xl">Post not found or you do not have permission to view it.</h1>';
                }
            } catch (error) {
                console.error("Error fetching post:", error);
                document.getElementById('post-container').innerHTML = '<h1 class="text-white text-center text-2xl">Error loading the post.</h1>';
            }

            const replyButtons = document.querySelectorAll('[data-reply]');
            
            replyButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const commentId = this.getAttribute('data-reply');
                    const replyForm = document.querySelector(`#reply-form-${commentId}`);
                    
                    // Create form if it doesn't exist
                    if (!replyForm) {
                        const commentContainer = this.closest('.bg-deep');
                        const newForm = document.createElement('div');
                        newForm.id = `reply-form-${commentId}`;
                        newForm.className = 'mt-4 pl-4 border-l-2 border-steel';
                        newForm.innerHTML = `
                            <div class="mb-3">
                                <textarea class="w-full p-3 border border-light rounded-lg focus:outline-none focus:ring-2 focus:ring-light bg-deep text-white" rows="3" placeholder="Write your reply..."></textarea>
                                <div class="flex gap-2 mt-2">
                                    <button class="px-4 py-1 bg-light text-steel rounded hover:bg-white transition" data-submit-reply="${commentId}">Post</button>
                                    <button class="px-4 py-1 border border-light text-white rounded hover:bg-deep transition" data-cancel-reply="${commentId}">Cancel</button>
                                </div>
                            </div>
                        `;
                        commentContainer.appendChild(newForm);
                    }
                    
                    replyForm?.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                });
            });

            // Handle form submission and cancellation
            document.addEventListener('click', function(e) {
                if (e.target.hasAttribute('data-submit-reply')) {
                    const commentId = e.target.getAttribute('data-submit-reply');
                    const textarea = document.querySelector(`#reply-form-${commentId} textarea`);
                    const replyText = textarea.value.trim();
                    
                    if (replyText) {
                        // In a real app, you would send this to your backend
                        alert(`Reply posted to comment ${commentId}: ${replyText}`);
                        document.querySelector(`#reply-form-${commentId}`).remove();
                    }
                }
                
                if (e.target.hasAttribute('data-cancel-reply')) {
                    const commentId = e.target.getAttribute('data-cancel-reply');
                    document.querySelector(`#reply-form-${commentId}`).remove();
                }
            });
        });
    </script>
</body>
</html>